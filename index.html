<!DOCTYPE html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id='pageTitle'>Luna Editor</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="static/styles/main.css">
</head>

<body>
    <ul>
        <li class="dropdown">
            <a href="javascript:void(0)" class="dropbtn">File</a>
            <div class="dropdown-content">
                <a onclick="newFile()">New File <span class="smallText">Shift + N</span></a>
                <hr>
                <a onclick="openFile()">Open File(s) <span class="smallText">Ctrl + O</span></a>
                <a onclick="openFileFromLink()">Open File from Link</a>
                <hr>
                <a onclick="saveFile()">Save <span class="smallText">Ctrl + S</span></a>
                <hr>
                <a onclick="downloadFile()">Download File <span class="smallText">Ctrl + D</span></a>
                <a onclick="downloadWorkspace()">Download Workspace</a>
                <hr>
                <a onclick="renameFile()">Rename File <span class="smallText">F2</span></a>
                <a onclick="clearWorkspace()">Clear Workspace</a>
                <a onclick="openPreferences()">Preferences</a>
            </div>
        </li>
        <li class="dropdown">
            <a href="javascript:void(0)" class="dropbtn">Edit</a>
            <div class="dropdown-content">
                <a onclick="doUndo()">Undo <span class='smallText'>Ctrl + Z</span></a>
                <a onclick="doRedo()">Redo <span class='smallText'>Ctrl + Y</span></a>
            </div>
        </li>
        <li class="dropdown branding">
            <a class="dropbtn">Luna</a>
            <div class="dropdown-content">
                <a href="https://github.com/nanna7077/Luna" target="_blank">Version 0.1a</a>
                <a id="monacoversion"></a>
                <a onclick="document.getElementById('keyboardShortcuts').style.display='block'">Keyboard Shortcuts</a>
            </div>
        </li>
    </ul>
    <div class="tabs" id="tabdisplay">
        <div class="tab" onclick="newFile()">+</div>
    </div>
    <div class="dialogBig" id="preferences">
        <div class="dialogBig-majortext">Preferences</div>
        <div class="dialogBig-categories">
            <div class="dialogBig-categories-category" onclick="showCategory('general')" id="category-general">General</div>
            <div class="dialogBig-categories-category" onclick="showCategory('editor')" id="category-editor">Editor</div>
        </div>
        <div class="dialogBig-options" id="preferences-general-values">
            <div class="dialogBig-options-option">
                <div class="dialogBig-options-option-title">Theme</div>
                <input type="radio" name="colortheme" value="light" onclick="addToConfig('theme', 'lunalight')" id="preferencesThemeLight"> Light
                <input type="radio" name="colortheme" value="dark" onclick="addToConfig('theme', 'lunadark')" id="preferencesThemeDark"> Dark
            </div>
        </div>
        <div class="dialogBig-options" id="preferences-editor-values">
            <div class="dialogBig-options-option">
                <div class="dialogBig-options-option-title">Tab Size</div>
                <input class="textInput" type="number" min="1" id="preferencesTabSize" onchange="addToMonacoConfig('tabSize', document.getElementById('preferencesTabSize').value)">
            </div>
            <div class="dialogBig-options-option">
                <div class="dialogBig-options-option-title">Auto Closing Brackets</div>
                <input type="checkbox" id="preferencesAutoClosingBrackets" onchange="addToMonacoConfig('autoClosingBrackets', document.getElementById('preferencesAutoClosingBrackets').checked)">
            </div>
            <div class="dialogBig-options-option">
                <div class="dialogBig-options-option-title">Bracket Pair Colorization</div>
                <input type="checkbox" id="preferencesBracketPairColorization" onchange="addToMonacoConfig(`'bracketPairColorization.enabled'`, document.getElementById('preferencesBracketPairColorization').checked)">
            </div>
        </div>
        <button class="button" onclick="hideDiv('preferences')">Close</button>
    </div>
    <div class="dialogBig" id="keyboardShortcuts">
        <div class="dialogBig-majortext">Keyboard Shortcuts</div>
        <div class="dialogBig-content">
            <kbd>Ctrl</kbd>+<kbd>O</kbd> - Open File
            <br><br>
            <kbd>Shift</kbd>+<kbd>N</kbd> - New File
            <br><br>
            <kbd>Ctrl</kbd>+<kbd>S</kbd> - Save Current File
            <br><br>
            <kbd>Ctrl</kbd>+<kbd>D</kbd> - Download Current File
            <br><br>
            <kbd>Shift</kbd>+<kbd>W</kbd> - Close Current File
            <br><br>
            <kbd>F2</kbd> - Rename Current File
        </div>
        <br><br>
        <button class="button" onclick="hideDiv('keyboardShortcuts')">Close</button>
    </div>
    <div class="dialog" id="renameDialog" style="display: none;">
        <div class="dialog-title">Rename File</div>
        <input class="textInput" id="renameDialogNewFilename" autocomplete="off">
        <br>
        <button class="button" onclick="triggerFileRenameFromDialog()">Rename</button>
        <button class="button" onclick="hideDiv('renameDialog')">Close</button>
    </div>
    <div class="dialog" id="openFromLinkDialog" style="display: none;">
        <div class="dialog-title">Open File from link</div>
        <input class="textInput" id="fileFromLinkText" autocomplete="off">
        <br>
        <button class="button" onclick="triggerFileOpenFromLinkFromDialog()">Open</button>
        <button class="button" onclick="hideDiv('openFromLinkDialog')">Close</button>
    </div>
    <div class="editor-container"></div>
    <div id="statusBar">

    </div>
</body>

<script type="text/javascript" src="https://unpkg.com/monaco-editor@latest/min/vs/loader.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jszip@3.7.1/dist/jszip.min.js"></script>
<script src="static/js/filetypes.js"></script>
<script src="static/js/main.js"></script>
<script>
    loadconfig()
</script>
<script src="static/js/themes.js"></script>
<script src="static/js/dragdrop.js"></script>
<script>
    var lunaIntroText = `


██╗     ██╗   ██╗███╗   ██╗ █████╗ 
██║     ██║   ██║████╗  ██║██╔══██╗
██║     ██║   ██║██╔██╗ ██║███████║
██║     ██║   ██║██║╚██╗██║██╔══██║
███████╗╚██████╔╝██║ ╚████║██║  ██║
╚══════╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝
                                   

Yet another web based code editor cos' why not?
`;
    require.config({
        paths: {
            'vs': 'https://unpkg.com/monaco-editor@latest/min/vs'
        }
    });
    window.MonacoEnvironment = {
            getWorkerUrl: function(workerId, label) {
                    return `data:text/javascript;charset=utf-8,${encodeURIComponent(`
        self.MonacoEnvironment = {
          baseUrl: 'https://unpkg.com/monaco-editor@latest/min/'
        };
        importScripts('https://unpkg.com/monaco-editor@latest/min/vs/base/worker/workerMain.js');`
      )}`;
    }
  };

  require(["vs/editor/editor.main"], function () {
    monaco.editor.defineTheme('lunatheme', lunatheme)
    document.editor=monaco.editor.create(document.querySelector('.editor-container'), {
      value: lunaIntroText,
      theme: 'lunatheme',
      automaticLayout: true,
      formatOnPaste: true,
      formatOnType: true,
    });
    loadMonacoConfig();
    loadLastSession();
  });
</script>
<script src="static/js/keyboardShortcuts.js"></script>

</html>
